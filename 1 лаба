import os
import pandas as pd
from kaggle.api.kaggle_api_extended import KaggleApi

api = KaggleApi()
api.authenticate()
dataset = "muonneutrino/us-census-demographic-data"
api.dataset_download_files(dataset, path='./data', unzip=True)

csv_files=[file for file in os.listdir('./data') if file.endswith('.csv')]
csv_path=os.path.join('./data', csv_files[0])

df=pd.read_csv(csv_path, low_memory=False)
transport_keywords = ['car', 'vehicle', 'auto', 'drive', 'commut', 'transport', 'work', 'travel']
car_related_columns = []

for col in df.columns:
    col_lower = col.lower()
    for keyword in transport_keywords:
        if keyword in col_lower:
            car_related_columns.append(col)
            break

print("\nСтолбцы, связанные с транспортом и автомобилями:")
for col in car_related_columns:
    print(f"- {col}")
if car_related_columns:

    priority_keywords = ['drive', 'car', 'vehicle', 'auto']

    for keyword in priority_keywords:
        for col in car_related_columns:
            if keyword in col.lower():
                target_column = col
                print(f"\n Выбран целевой признак: '{target_column}'")
                break
        else:
            continue
        break
    else:
        # Если не нашли по приоритетным ключевым словам, берем первый из списка
        target_column = car_related_columns[0]
        print(f"\n Выбран целевой признак: '{target_column}'")
